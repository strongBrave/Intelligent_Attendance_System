<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="header">
    <text class="title">è€ƒå‹¤è®°å½•</text>
  </view>

  <!-- æŸ¥è¯¢æ¡ä»¶ -->
  <view class="query-section">
    <view class="query-form">
      <!-- æ—¥æœŸé€‰æ‹© -->
      <view class="form-item">
        <text class="label">æ—¥æœŸèŒƒå›´</text>
        <picker mode="date" value="{{startDate}}" start="2020-01-01" end="{{today}}" bindchange="onStartDateChange">
          <view class="picker">
            <text class="picker-text">{{startDate || 'å¼€å§‹æ—¥æœŸ'}}</text>
            <text class="picker-arrow">></text>
          </view>
        </picker>
        <text class="separator">è‡³</text>
        <picker mode="date" value="{{endDate}}" start="2020-01-01" end="{{today}}" bindchange="onEndDateChange">
          <view class="picker">
            <text class="picker-text">{{endDate || 'ç»“æŸæ—¥æœŸ'}}</text>
            <text class="picker-arrow">></text>
          </view>
        </picker>
      </view>

      <!-- å¿«æ·æ—¥æœŸé€‰æ‹© -->
      <view class="quick-dates">
        <text class="quick-label">å¿«æ·é€‰æ‹©:</text>
        <view class="quick-buttons">
          <button class="quick-btn" bindtap="setDateRange" data-range="today">ä»Šå¤©</button>
          <button class="quick-btn" bindtap="setDateRange" data-range="yesterday">æ˜¨å¤©</button>
          <button class="quick-btn" bindtap="setDateRange" data-range="thisWeek">æœ¬å‘¨</button>
          <button class="quick-btn" bindtap="setDateRange" data-range="lastWeek">ä¸Šå‘¨</button>
          <button class="quick-btn" bindtap="setDateRange" data-range="thisMonth">æœ¬æœˆ</button>
          <button class="quick-btn" bindtap="setDateRange" data-range="lastMonth">ä¸Šæœˆ</button>
        </view>
      </view>

      <!-- æŸ¥è¯¢æŒ‰é’® -->
      <view class="query-actions">
        <button class="query-btn" bindtap="queryRecords" loading="{{loading}}">æŸ¥è¯¢</button>
        <button class="reset-btn" bindtap="resetQuery">é‡ç½®</button>
      </view>
    </view>
  </view>

  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="stats-section" wx:if="{{stats.total > 0}}">
    <view class="stats-title">ç»Ÿè®¡ä¿¡æ¯</view>
    <view class="stats-grid">
      <view class="stats-item">
        <text class="stats-number">{{stats.total}}</text>
        <text class="stats-label">æ€»è®°å½•</text>
      </view>
      <view class="stats-item">
        <text class="stats-number normal">{{stats.normal_sign_in}}</text>
        <text class="stats-label">ğŸ“¥ æ­£å¸¸ç­¾åˆ°</text>
      </view>
      <view class="stats-item">
        <text class="stats-number normal">{{stats.normal_sign_out}}</text>
        <text class="stats-label">ğŸ“¤ æ­£å¸¸ç­¾é€€</text>
      </view>
      <view class="stats-item">
        <text class="stats-number late">{{stats.late}}</text>
        <text class="stats-label">è¿Ÿåˆ°</text>
      </view>
      <view class="stats-item">
        <text class="stats-number early">{{stats.early_leave}}</text>
        <text class="stats-label">æ—©é€€</text>
      </view>
      <view class="stats-item">
        <text class="stats-number late">{{stats.late_leave}}</text>
        <text class="stats-label">æ™šé€€</text>
      </view>
      <view class="stats-item">
        <text class="stats-number absent">{{stats.absent}}</text>
        <text class="stats-label">ç¼ºå‹¤</text>
      </view>
    </view>
  </view>

  <!-- è€ƒå‹¤è®°å½•åˆ—è¡¨ -->
  <view class="records-section">
    <view class="records-header">
      <text class="records-title">è€ƒå‹¤è®°å½• ({{records.length}}æ¡)</text>
    </view>
    
    <view class="records-list" wx:if="{{records.length > 0}}">
      <view class="record-item" wx:for="{{records}}" wx:key="id">
        <view class="record-header">
          <text class="record-date">{{item.date}}</text>
          <view class="record-type-status">
            <text class="record-type">{{item.checkTypeText}}</text>
            <text class="record-status {{item.status}}">{{item.statusText}}</text>
          </view>
        </view>
        <view class="record-content">
          <view class="record-time">
            <text class="time-label">{{item.checkTypeText}}æ—¶é—´:</text>
            <text class="time-value">{{item.time_display || 'æœªè®°å½•'}}</text>
          </view>
          <view class="record-location">
            <text class="location-label">{{item.checkTypeText}}åœ°ç‚¹:</text>
            <text class="location-value">{{item.location_display}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{!loading && records.length === 0}}">
      <text class="empty-text">æš‚æ— è€ƒå‹¤è®°å½•</text>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-state" wx:if="{{loading}}">
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>
  </view>
</view> 